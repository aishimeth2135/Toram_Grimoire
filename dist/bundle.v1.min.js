!function(e){var t={};function a(n){if(t[n])return t[n].exports;var l=t[n]={i:n,l:!1,exports:{}};return e[n].call(l.exports,l,l.exports,a),l.l=!0,l.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)a.d(n,l,function(t){return e[t]}.bind(null,l));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=7)}([function(e,t,a){"use strict";var n=a(6),l=a(3),i=a(2),r=a(1);function s(e){return Object(l.a)("Skill Query/Controller/"+e)}const c=Symbol(),o=Symbol(),d=Symbol(),p=Symbol();function u(e){this.MAIN_NODE=null,this.skillRoot=e,this.currentData={skillRoot:e,mainWeapon:-1,subWeapon:-1,bodyArmor:-1,skillLevel:10,characterLevel:185,currentSkill:null,stackValues:{},stackNames:{},showOriginalFormula:!1,skillRecords:[]}}u.prototype={initSkillQueryHTML(e){const t=this.skillRoot;this.MAIN_NODE=e;const a=[f.TYPE,b.TYPE,g.TYPE,c,o,d,g.CATEGORY_EQUIPMENT,p,L.TYPE],n=document.createDocumentFragment();a.forEach(function(e){const a=this.getSkillElementScope(e);switch(n.appendChild(a),e){case f.TYPE:a.appendChild(this.createSkillQueryScopeHTML(t,Object(i.a)().menu));break;case b.TYPE:t.skillTreeCategorys.forEach(function(e){a.appendChild(this.createSkillQueryScopeHTML(e,Object(i.a)().menu))},this);break;case p:a.classList.add("hidden");case c:case o:case d:a.appendChild(this.createSkillQueryScopeHTML(null,e))}},this),e.appendChild(n),this.currentData.skill_from_where_scope=r.a.element.simpleCreateHTML("div",["show_skill_from_where","hidden"])},getSkillElementScope(e){const t={[f.TYPE]:"SkillRoot_scope",[b.TYPE]:"SkillTreeCategory_scope",[g.TYPE]:"SkillTree_scope",[L.TYPE]:"Skill_scope",[c]:"SkillLevel_scope",[o]:"CharacterLevel_scope",[d]:"SwitchDisplayMode_scope",[g.CATEGORY_EQUIPMENT]:"SkillEquipment_scope",[p]:"SkillRecord_scope"};let a=this.MAIN_NODE.getElementsByClassName(t[e])[0];return a||(a=document.createElement("div")).classList.add(t[e]),a},getSkillElementNoStr(e){let t="";for(;e.parent;)t=e.findLocation()+(""!=t?"-":"")+t,e=e.parent;return t},selectSkillElement(e){const t=e.split("-");let a=null;return t.forEach(function(e,t){switch(e=parseInt(e,10),t){case 0:a=this.skillRoot.skillTreeCategorys[e];break;case 1:a=a.skillTrees[e];break;case 2:a=a.skills[e];break;case 3:a=a.branchs[e]}},this),a},skillRecord(e){this.currentData.skillRecords.push(this.currentData.currentSkill),this.initCurrentSkill(e),this.updateSkillHTML()},popSkillRecord(){this.initCurrentSkill(this.currentData.skillRecords.pop()),this.updateSkillHTML()},clearSkillRecord(){const e=this.currentData.skillRecords;e.splice(0,e.length)},equipmentCheck:(e,t)=>-1==e.mainWeapon&&-1==e.subWeapon&&-1==e.bodyArmor||(-1!=t.mainWeapon&&t.mainWeapon==e.mainWeapon||(-1!=t.subWeapon&&t.subWeapon==e.subWeapon||-1!=t.bodyArmor&&t.bodyArmor==e.bodyArmor)),setCurrentEquipment(e,t){const a=this.currentData;if(void 0!==a[e]){if(-1!==t){let n=[[5],[0,1,2,3,4,5],[1,2,3,4],[5],[3,5],[0,1,2,3,4,5],[4,5],[1,3,4,5],[1,3,4,5],[0,1,2,3,4,5]];switch(e){case"mainWeapon":if(-1!==n[t].indexOf(a.subWeapon)){const e=this.getSkillElementScope(g.CATEGORY_EQUIPMENT).querySelector(`li[${Object(i.a)().data_subWeapon}="-1"]`);e?e.click():a.subWeapon=-1}break;case"subWeapon":if(-1!==a.mainWeapon&&-1!==n[a.mainWeapon].indexOf(t)){const e=this.getSkillElementScope(g.CATEGORY_EQUIPMENT).querySelector(`li[${Object(i.a)().data_mainWeapon}="-1"]`);e?e.click():a.mainWeapon=-1}}}a[e]=t,this.getSkillElementScope(g.TYPE).querySelectorAll("table td").forEach(e=>{const t=e.getAttribute(Object(i.a)().data_skillElementNo);null!==t&&(void 0===this.selectSkillElement(t).effects.find(e=>this.equipmentCheck(e,a))?e.classList.add("disable"):e.classList.remove("disable"))})}else console.warn("Unknow equipment field name")},initCurrentSkill(e){this.currentData.currentSkill=e,e.checkData()&&(r.a.object.empty(this.currentData.stackValues),this.currentData.stackValues=null);const t=this.getSkillElementScope(p);t.classList.remove("hidden"),this.currentData.skillRecords.length>0?t.querySelector(".back_button").classList.remove("hidden"):t.querySelector(".back_button").classList.add("hidden"),t.querySelector("div.current_skill").innerHTML=e.name},updateSkillHTML(){const e=this.currentData.currentSkill;if(!e)return;const t=this.getSkillElementScope(L.TYPE);r.a.element.removeAllChild(t),t.appendChild(this.createSkillQueryScopeHTML(e,L.CATEGORY_MAIN))},createSkillQueryScopeHTML(e,t){switch(null!==e?e.TYPE:t){case f.TYPE:switch(t){case Object(i.a)().menu:{const a=this,n=function(e){const t=this.parentNode.getElementsByClassName("cur")[0];t&&t.classList.remove("cur"),this.classList.add("cur");a.getSkillElementScope(b.TYPE);let n=Array.from(this.parentNode.getElementsByTagName("li")).indexOf(this),l=a.getSkillElementScope(b.TYPE).querySelectorAll("div._menu");const i=Array.from(l).find(e=>!e.classList.contains("hidden"));i&&i.classList.add("hidden"),l[n].classList.remove("hidden"),r.a.element.removeAllChild(a.getSkillElementScope(g.TYPE)),r.a.element.removeAllChild(a.getSkillElementScope(L.TYPE)),r.a.element.removeAllChild(a.getSkillElementScope(g.CATEGORY_EQUIPMENT));const s=l[n].querySelector("li.cur");s&&s.click()},l=document.createElement("div");l.className="_"+t;const s=document.createDocumentFragment();e.skillTreeCategorys.forEach(e=>{const t=document.createElement("li");t.innerHTML=e.name,t.setAttribute(Object(i.a)().data_skillElementNo,a.getSkillElementNoStr(e)),t.addEventListener("click",n),s.appendChild(t)});const c=document.createElement("ul");return c.appendChild(s),l.appendChild(c),l}}case b.TYPE:switch(t){case Object(i.a)().menu:{const a=this,n=function(e){const t=this.parentNode.getElementsByClassName("cur")[0];t&&t.classList.remove("cur"),this.classList.add("cur");const n=a.getSkillElementScope(g.TYPE);n.innerHTML="";const l=a.selectSkillElement(this.getAttribute(Object(i.a)().data_skillElementNo));n.appendChild(a.createSkillQueryScopeHTML(l,g.CATEGORY_TABLE));const s=a.createSkillQueryScopeHTML(l,g.CATEGORY_EQUIPMENT),c=a.getSkillElementScope(g.CATEGORY_EQUIPMENT);if(r.a.element.removeAllChild(c),null!==s){c.appendChild(s);let e=a.getSkillElementScope(g.CATEGORY_EQUIPMENT).querySelector(`li[${Object(i.a)().data_bodyArmor}="${a.currentData.bodyArmor}"]`);e&&e.click(),(e=a.getSkillElementScope(g.CATEGORY_EQUIPMENT).querySelector(`li[${Object(i.a)().data_mainWeapon}="${a.currentData.mainWeapon}"]`))&&e.click()}r.a.element.removeAllChild(a.getSkillElementScope(L.TYPE))},l=document.createElement("div");l.className="_"+t,l.classList.add("hidden");const s=document.createDocumentFragment();e.skillTrees.forEach(function(e){const t=document.createElement("li");t.innerHTML=e.name,t.setAttribute(Object(i.a)().data_skillElementNo,a.getSkillElementNoStr(e)),t.addEventListener("click",n),s.appendChild(t)});const c=document.createElement("ul");return c.appendChild(s),l.appendChild(c),l}}case g.TYPE:switch(t){case g.CATEGORY_TABLE:{const t=e,a=t.parent.findLocation(),n=t.findLocation(),l=this,r=function(e){const t=l.selectSkillElement(this.getAttribute(Object(i.a)().data_skillElementNo));if(this.classList.contains("disable")||l.currentData.currentSkill===t)return;const a=this.parentNode.parentNode.getElementsByClassName("cur")[0];a&&a.classList.remove("cur"),this.classList.add("cur"),l.clearSkillRecord(),l.initCurrentSkill(t),l.updateSkillHTML()},s=function(e){let t=document.createElement("table");return e.ary.forEach(function(e){let a=document.createDocumentFragment();e.forEach(function(e){let t=document.createElement("td");if(e>1&&t.setAttribute("rowspan",e),a.appendChild(t),e<-1)for(++e;0!=e;){++e;const t=document.createElement("td");t.setAttribute("data-empty","1"),a.appendChild(t)}});let n=document.createElement("tr");n.appendChild(a),t.appendChild(n)}),t}(function(e,t){let a=null;switch(e){case 0:switch(t){case 0:a=[[4,2,2,1],[1],[2,2,1],[1],[2,2,-2],[1,1]];break;case 1:a=[[3,2,-3],[1,-2],[1,1,1,1],[2,-4],[1,1,-2]];break;case 2:a=[[2,1,1,1,1],[1,1,1,1],[-5],[1,1,1,-2]];break;case 3:a=[[2,1,1,1,1],[1,1,1,1],[1,1,-3],[1,-4]];break;case 4:a=[[4,1,1,-2],[1,1,1,1],[1,1,-2],[1,1,-2]];break;case 5:a=[[4,2,2,1],[1],[2,1,1],[-2],[1,-3],[1,1,-2]];break;case 6:a=[[2,2,2,2,1],[1],[1,1,-3],[2,-4],[1,1,-2]]}break;case 1:switch(t){case 0:a=[[2,1,1],[-2],[2,1,1],[-2]];break;case 1:case 2:a=[[2,1,1,1],[1,-2],[1,1,-2]];break;case 3:case 4:case 5:a=[[1,1,1,1],[1,1,1,1]]}break;case 2:switch(t){case 0:a=[[-4],[1,1,1,1],[1,1,1,1],[1,1,1,1]];break;case 1:a=[[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1]];break;case 2:a=[[-2],[-2],[-2],[2,1],[1],[2,1],[1]]}break;case 3:switch(t){case 0:a=[[4,1,1,1,1],[1,1,-2],[2,1,-2],[1,1,1],[-5]];break;case 1:a=[[3,1,1,1,1],[1,1,-2],[1,1,-2],[1]];break;case 2:a=[[3,1,1],[1,1],[1,1]]}break;case 4:switch(t){case 0:case 1:a=[[1,1,1],[1,1,1]]}}return null===a&&(a=[[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]]),{ary:a}}(a,n));let c=-1;return Array.from(s.getElementsByTagName("td")).forEach(function(e){if("1"==e.getAttribute("data-empty"))return;++c;const a=t.skills[c];void 0!==a?"@lock"!=a.name?(e.innerHTML=a.name,e.setAttribute(Object(i.a)().data_skillElementNo,l.getSkillElementNoStr(a)),e.addEventListener("click",r)):e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none"><path d="M0 0h24v24H0V0z"/><path opacity=".87" d="M0 0h24v24H0V0z"/></g><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zM9 8V6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9z"/></svg>':e.innerHTML="-"}),s}case g.CATEGORY_EQUIPMENT:{const t=this,a=function(e){const a=["mainWeapon","subWeapon","bodyArmor"],n=[this.getAttribute(Object(i.a)().data_mainWeapon),this.getAttribute(Object(i.a)().data_subWeapon),this.getAttribute(Object(i.a)().data_bodyArmor)];for(let e=0;e<n.length;++e){const l=n[e];if(null!==l&&""!==l)return t.setCurrentEquipment(a[e],parseInt(l,10)),this.parentNode.getElementsByClassName("cur")[0].classList.remove("cur"),this.classList.add("cur"),void t.updateSkillHTML()}},n=[],r=[],c=[];e.skills.forEach(e=>{e.effects.forEach(e=>{const t=e.mainWeapon,a=e.subWeapon,l=e.bodyArmor;-1==n.indexOf(t)&&n.push(t),-1==r.indexOf(a)&&r.push(a),-1==c.indexOf(l)&&c.push(l)})});const o=document.createDocumentFragment(),d=["mainWeapon","subWeapon","bodyArmor"];return[n,r,c].forEach((e,t)=>{if(0!==e.length&&(1!=e.length||-1!=e[0])){let p,u,_,h;switch(e){case n:h=Object(i.a)().data_mainWeapon,_=s("main weapon"),p=["","","","","","","","","",""],u=Object(l.a)("Skill Query/Analysis Skill/Main Weapon List");break;case r:h=Object(i.a)().data_subWeapon,_=s("sub weapon"),p=["","","","","",""],u=Object(l.a)("Skill Query/Analysis Skill/Sub Weapon List");break;case c:h=Object(i.a)().data_bodyArmor,_=s("body armor"),p=["","",""],u=Object(l.a)("Skill Query/Analysis Skill/Body Armor List")}let m=null,E=!1;const f=document.createElement("ul");e.forEach(e=>{const n=document.createElement("li");n.setAttribute(h,e),n.addEventListener("click",a),-1!=e?(n.innerHTML=`<span class="icon">${p[e]}</span><span class="value">${u[e]}</span>`,f.appendChild(n),E||(n.classList.add("cur"),this.currentData[d[t]]=e,E=!0)):(n.innerHTML=`<span class="icon"></span><span class="value">${s("equipment: unlimited")}</span>`,m=n)}),null!==m&&f.appendChild(m);const b=document.createElement("div"),g=document.createElement("div");g.innerHTML=_,b.appendChild(g),b.appendChild(f),o.appendChild(b)}}),0!=o.childElementCount?o:null}}case L.TYPE:switch(t){case L.CATEGORY_MAIN:{if(e.checkData())return Object(n.a)(this.currentData);const t=document.createElement("div");return t.classList.add("no_data"),t.innerHTML="此技能資料尚未更新。",t}}case o:{const e=this,t=r.a.element.simpleCreateHTML("span","left",'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M18 13H6c-.55 0-1-.45-1-1s.45-1 1-1h12c.55 0 1 .45 1 1s-.45 1-1 1z"/></svg>'),a=r.a.element.simpleCreateHTML("span","right",'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M18 13h-5v5c0 .55-.45 1-1 1s-1-.45-1-1v-5H6c-.55 0-1-.45-1-1s.45-1 1-1h5V6c0-.55.45-1 1-1s1 .45 1 1v5h5c.55 0 1 .45 1 1s-.45 1-1 1z"/></svg>'),n=r.a.element.simpleCreateHTML("input","mid");n.value=this.currentData.characterLevel;const i=function(t){let a=parseInt(n.value,10);switch(this.getAttribute("data-ctr")){case"-":a-=10;break;case"+":a+=10}a>185?a=185:a<0&&(a=0),n.value=a,e.currentData.characterLevel=a,e.updateSkillHTML()};t.setAttribute("data-ctr","-"),t.addEventListener("click",i),a.setAttribute("data-ctr","+"),a.addEventListener("click",i),n.type="number",n.addEventListener("change",i),n.addEventListener("focus",function(e){this.select()});const s=document.createDocumentFragment();return s.appendChild(r.a.element.simpleCreateHTML("div","title",Object(l.a)("Skill Query/Analysis Skill/character level"))),s.appendChild(t),s.appendChild(n),s.appendChild(a),s}case c:{const e=this,t=function(t){const a=e.currentData.currentSkill;this.parentNode.getElementsByClassName("cur")[0].classList.remove("cur"),this.classList.add("cur"),e.currentData.skillLevel=parseInt(this.getAttribute(Object(i.a)().data_skillLevel),10),null!=a&&e.updateSkillHTML()},a=1,n=10,l=document.createElement("ul");for(let e=a;e<=n;++e){const a=document.createElement("li");a.innerHTML="Lv. "+e,a.setAttribute(Object(i.a)().data_skillLevel,e),a.addEventListener("click",t),a.classList.add("global_button_1"),e==this.currentData.skillLevel&&a.classList.add("cur"),l.appendChild(a)}return l}case d:{const e=this,t=document.createDocumentFragment(),a=document.createElement("span");return a.appendChild(r.a.element.simpleCreateHTML("span","icon",'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M18.65 8.35l-2.79 2.79c-.32.32-.1.86.35.86H18c0 3.31-2.69 6-6 6-.79 0-1.56-.15-2.25-.44-.36-.15-.77-.04-1.04.23-.51.51-.33 1.37.34 1.64.91.37 1.91.57 2.95.57 4.42 0 8-3.58 8-8h1.79c.45 0 .67-.54.35-.85l-2.79-2.79c-.19-.2-.51-.2-.7-.01zM6 12c0-3.31 2.69-6 6-6 .79 0 1.56.15 2.25.44.36.15.77.04 1.04-.23.51-.51.33-1.37-.34-1.64C14.04 4.2 13.04 4 12 4c-4.42 0-8 3.58-8 8H2.21c-.45 0-.67.54-.35.85l2.79 2.79c.2.2.51.2.71 0l2.79-2.79c.31-.31.09-.85-.36-.85H6z"/></svg>')),a.appendChild(r.a.element.simpleCreateHTML("span","title",s("switch display"))),a.addEventListener("click",function(t){e.currentData.showOriginalFormula=!e.currentData.showOriginalFormula,e.updateSkillHTML()}),t.appendChild(a),t}case p:{const e=this,t=document.createDocumentFragment(),a=r.a.element.simpleCreateHTML("div","back_button");a.appendChild(r.a.element.simpleCreateHTML("span","icon",'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M14.71 15.88L10.83 12l3.88-3.88c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0L8.71 11.3c-.39.39-.39 1.02 0 1.41l4.59 4.59c.39.39 1.02.39 1.41 0 .38-.39.39-1.03 0-1.42z"/></svg>')),a.appendChild(r.a.element.simpleCreateHTML("span","caption",Object(l.a)("Skill Query/button text/back"))),a.addEventListener("click",function(t){e.popSkillRecord()});const n=r.a.element.simpleCreateHTML("div","current_skill");return t.appendChild(a),t.appendChild(r.a.element.simpleCreateHTML("div","tip",s("current skill"))),t.appendChild(n),t}}}};var _=u,h=a(4),m=a(5);function E(){Array.from(arguments).forEach(function(e,t){null==e&&(console.log(`argument[${t}] of Constructor is null`),console.log(arguments))})}function f(){this.skillTreeCategorys=[],this.controller=new _(this)}function b(e,t,a){this.parent=e,this.no=t,this.name=a,this.skillTrees=[]}function g(e,t,a){this.parent=e,this.no=t,this.name=a,this.skills=[]}function L(e,t,a){this.parent=e,this.name=a,this.effects=[],this.defaultEffect=null,this.caption=""}function T(e,t,a,n){this.parent=e,this.branchs=[],this.mainWeapon=t,this.subWeapon=a,this.bodyArmor=n,this.attributes={}}function k(e,t,a){this.parent=e,this.no=t,this.name=a,this.branchAttributes={},this.stats=[]}a.d(t,"d",function(){return f}),a.d(t,"f",function(){return b}),a.d(t,"e",function(){return g}),a.d(t,"a",function(){return L}),a.d(t,"c",function(){return T}),a.d(t,"b",function(){return k}),f.TYPE=Symbol("SkillRoot"),f.prototype={TYPE:f.TYPE,newElement(e,t){if(e==b.TYPE){const{name:e,no:a}=t;E(a,e);let n=new b(this,a,e);return this.skillTreeCategorys.push(n),n}return null},findSkillByName(e){let t=void 0;return this.skillTreeCategorys.forEach(a=>{t||a.skillTrees.forEach(a=>{if(t)return;const n=a.skills.find(t=>t.name===e);void 0!==n&&(t=n)})}),t}},b.TYPE=Symbol("SkillTreeCategory"),b.prototype={TYPE:b.TYPE,newElement(e,t){if(e==g.TYPE){const{name:e,no:a}=t;E(a,e);let n=new g(this,a,e);return this.skillTrees.push(n),n}return null},findLocation(){return this.parent.skillTreeCategorys.indexOf(this)}},g.TYPE=Symbol("SkillTree"),g.prototype={TYPE:g.TYPE,newElement(e,t){if(e==L.TYPE){const{name:e,no:a}=t;E(a,e);let n=new L(this,a,e);return this.skills.push(n),n}return null},findLocation(){return this.parent.skillTrees.indexOf(this)}},g.CATEGORY_TABLE=Symbol(),g.CATEGORY_EQUIPMENT=Symbol(),L.TYPE=Symbol("Skill"),L.prototype={TYPE:L.TYPE,newElement(e,t){if(e==T.TYPE){const{mainWeapon:e,subWeapon:a,bodyArmor:n}=t;E(e,a,n);let l=new T(this,e,a,n);return this.effects.push(l),l}return null},findLocation(){return this.parent.skills.indexOf(this)},setDefaultEffect(e){return this.defaultEffect=e,this},checkData(){return void 0!==this.defaultEffect&&null!==this.defaultEffect}},L.CATEGORY_MAIN=Symbol(),T.TYPE=Symbol("SkillEffect"),T.prototype={TYPE:T.TYPE,newElement(e,t){if(e==k.TYPE){const e=t.no,a=t.name;E(e,a);let n=new k(this,e,a);return this.branchs.push(n),n}return null},findLocation(){return this.parent.effects.indexOf(this)},appendAttribute(e,t){return null!==t&&(this.attributes[e]=t),this}},T.MP_COST=Symbol("mp_cost"),T.RANGE=Symbol("range"),T.SKILL_TYPE=Symbol("skill_type"),T.IN_COMBO=Symbol("in_combo"),T.ACTION_TIME=Symbol("action_type"),T.CASTING_TIME=Symbol("casting_time"),k.TYPE=Symbol("SkillBranch"),k.prototype={TYPE:k.TYPE,appendBranchAttribute(e,t){return this.branchAttributes[e]=t,this},findLocation(){return this.parent.branchs.indexOf(this)},appendStat(e,t,a){let n;switch(a){case"":n=m.a.TYPE_CONSTANT;break;case"%":n=m.a.TYPE_MULTIPLIER;break;case"~":n=m.a.TYPE_TOTAL}const l=h.a.CharacterSystem.findStatBase(e).createSimpleStat(n,t);return this.stats.push(l),l}}},function(e,t,a){"use strict";let n={element:{remove:function(){Array.from(arguments);Array.from(arguments).forEach(function(e){e&&e.parentNode.removeChild(e)})},removeAllChild:function(e){if(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}},setAttributes:function(e,t){Object.keys(t).forEach(a=>{null!==t[a]&&e.setAttribute(a,t[a])})},simpleCreateHTML(e,t,a){const n=document.createElement(e);return null!==t&&(Array.isArray(t)?n.classList.add(...t):n.classList.add(t)),null!=a&&(n.innerHTML=a),n},convertRemToPixels:e=>e*parseFloat(getComputedStyle(document.documentElement).fontSize)},class:{extends:function(e){let t=Array.from(arguments);e.prototype=Object.create(t[1].prototype),t.forEach(function(t,a){a<=1||Object.assign(e.prototype,t.prototype)}),e.constructor=e}},object:{empty(e){null!==e&&"object"==typeof e&&Object.keys(e).forEach(function(t){delete e[t]})},isEmpty:e=>"object"!=typeof e||0==Object.keys(e).length},svg:{create(e,t,a={}){const l=document.createElementNS("http://www.w3.org/2000/svg","svg");return a=Object.assign({xmlns:"http://www.w3.org/2000/svg",width:e,height:t,viewBox:`0 0 ${e} ${t}`},a),n.element.setAttributes(l,a),l},drawCircle(e,t,a,l={}){const i=document.createElementNS("http://www.w3.org/2000/svg","circle");return l=Object.assign({cx:e,cy:t,r:a},l),n.element.setAttributes(i,l),i},drawPath(e,t={}){const a=document.createElementNS("http://www.w3.org/2000/svg","path");return t=Object.assign({d:e},t),n.element.setAttributes(a,t),a},drawSector(e,t,a,l,i,r,s,c={}){const o=document.createElementNS("http://www.w3.org/2000/svg","path");return c=Object.assign({d:n.svg.getSectorD(e,t,a,l,i,r,s),fill:"none"},c),n.element.setAttributes(o,c),o},getSectorD:(e,t,a,n,l,i,r)=>`M${a*Math.cos(i*Math.PI/180)+e} ${-a*Math.sin(i*Math.PI/180)+t} A${a} ${a} 0 0 ${1==r?0:1} ${a*Math.cos(l*Math.PI/180)+e} ${-a*Math.sin(l*Math.PI/180)+t} L${n*Math.cos(l*Math.PI/180)+e} ${-n*Math.sin(l*Math.PI/180)+t} A${n} ${n} 0 0 ${r} ${n*Math.cos(i*Math.PI/180)+e} ${-n*Math.sin(i*Math.PI/180)+t} Z`,createAnimate(e,t={}){t=Object.assign({attributeName:e,repeatCount:"indefinite"},t);const a=document.createElementNS("http://www.w3.org/2000/svg","animate");return n.element.setAttributes(a,t),a}}};t.a=n},function(e,t,a){"use strict";const n={menu:"menu",from:Symbol(),data_skillElementNo:"data-seno",data_mainWeapon:"data-mainw",data_subWeapon:"data-subw",data_bodyArmor:"data-armor",data_branchIndex:"data-bi"};t.a=function(){return n}},function(e,t,a){"use strict";var n={global:{second:"秒",cancel:"取消"},"Skill Query":{"Skill Element":{"skill tree: from":"所屬技能樹"},Controller:{"main weapon":"主手武器","sub weapon":"副手武器","body armor":"身體裝備","equipment: unlimited":"無限制","switch display":"切換顯示","current skill":"當前技能"},"Analysis Skill":{"no data":"此技能資料尚未齊全。","equipment not confirm":"所選取的裝備無法使用此技能。","Main Weapon List":["單手劍","雙手劍","弓","弩","法杖","魔導具","拳套","旋風槍","拔刀劍","雙劍"],"Sub Weapon List":["箭矢","盾牌","小刀","魔導具","拳套","拔刀劍"],"Body Armor List":["輕量化","重量化","一般"],"mp cost":"MP消耗",range:"射程","skill type":"類型","damage type":"傷害類型","poration type":"慣性類型","in combo":"連擊","action time":"動作時間","casting time":"詠唱時間","charging time":"蓄力時間","skill type: List":["瞬發","須詠唱","須蓄力","被動"],"damage type: List":["物理","魔法"],"poration type: List":["物理","魔法","一般攻擊"],"in combo: List":["可以放入連擊","無法放入連擊","不可放入連擊的第一招"],"action time: List":["極慢","慢","稍慢","一般","稍快","快","極快"],"range: no limit":"無限制","skill formula: STR":"角色STR","skill formula: DEX":"角色DEX","skill formula: INT":"角色INT","skill formula: AGI":"角色AGI","skill formula: VIT":"角色VIT","skill formula: BSTR":"角色基礎STR","skill formula: BDEX":"角色基礎DEX","skill formula: BINT":"角色基礎INT","skill formula: BAGI":"角色基礎AGI","skill formula: BVIT":"角色基礎VIT","skill formula: shield_refining":"盾精煉值","skill formula: dagger_atk":"小刀ATK","character level":"角色等級","skill level":"技能等級",physical:"物理",magic:"魔法","normal attack":"一般攻擊","damage poration type: none":"不受慣性影響","effective poration type: none":"不影響慣性","damage poration: title":"傷害慣性","effective poration: title":"造成慣性","element: neutral":"無屬性","element: fire":"火屬性","element: water":"水屬性","element: earth":"地屬性","element: wind":"風屬性","element: light":"光屬性","element: dark":"暗屬性","element: arrow":"套用箭矢屬性","element: one hand sword":"套用單手劍屬性","target type: self":"自身","target type: party":"全隊伍","target type: party & is place":"區域內的隊伍成員","target type: aura":"光環內的隊伍成員","target type: target":"目標",radius:"半徑","sector: angle":"夾角","effective area: title":"類別","effective area type: circle":"圓形","effective area type: line":"直線型","effective area type: sector":"扇型","move distanve: title":"移動距離","effective area: character position":"角色位置","effective area: target position":"目標位置",branch:{stack:{"base name":"技能層數","min value":"最小值","max value":"最大值"},damage:{"title type: one":"單下傷害","title type: total":"總傷害","title type: each":"每下傷害","title type: normal attack":"一般攻擊傷害提升","valid base: atk":"有效ATK","valid base: matk":"有效MATK","skill constant":"技能常數","skill multiplier":"技能倍率",chance:"機率",aliment:"異常狀態","target type: single":"單體","target type: AOE":"範圍","is place":"設置型",frequency:"傷害次數","judgment: common":"共同判定","judgment: separate":"分開判定","cycle: preText":"每",extra:{"base title":"額外效果"}},effect:{"condition: auto":"施放成功後","condition: hit":"命中成功後","condition: next":"下一招技能","condition: next-2":["之後的","招技能"],"condition: passive":"被動效果",duration:"持續時間","duration-2":["","秒內"]},heal:{"title: hp":"HP恢復","title: mp":"MP恢復",frequency:"作用次數"},reference:{"reference url":"資料參考連結"}},"button text":{"to skill":"查看"}},"button text":{back:"返回"}},"stat base":{"type total: preText":"總"}};var l={global:{second:" sec"},"Analysis Skill":{"character level":"Character Level","skill level":"Skill Level"}};var i={};function r(e,t){t=t.split("/");let a=0,n=e;for(;a!==t.length;)if(n=n[t[a]],++a,void 0===n)return;return n}function s(e){const t=[l,n,i];let a=r(t[1],e);if(void 0===a){let n=!1;return t.forEach(t=>{n||void 0!==(a=r(t,e))&&(n=!0)}),void 0===a?(console.warn(`[Unknow Language data] id: ${e}`),console.log((new Error).stack),console.log(t),"???"):a}return a}a.d(t,"a",function(){return s})},function(e,t,a){"use strict";t.a={}},function(e,t,a){"use strict";var n=a(3);function l(e){return Object(n.a)("stat base/s")}function i(e,t,a){this.baseName=e,this.caption=t,this.hasMultiplier=a,this.attributes=[]}function r(e,t,a=0){this.base=e,this.type=t,this.value=a}i.TYPE_CONSTANT=Symbol(),i.TYPE_MULTIPLIER=Symbol(),i.TYPE_TOTAL=Symbol(),i.prototype={appendAttribute(e,t){return e&&null!=t&&(this.attributes[e]=t),this},show(e,t){switch("number"!=typeof t&&(t=parseInt(t)),e){case i.TYPE_CONSTANT:{let e=this.caption;return e+=t<0?"":"+",e+=t,this.hasMultiplier||(e+=void 0===this.attributes.constant_unit?"%":this.attributes.constant_unit),e}case i.TYPE_MULTIPLIER:{let e=this.caption;return e+=t<0?"":"+",e+=t,e+="%"}case i.TYPE_TOTAL:{let e=l()+this.caption;return e+=t<0?"":"+",e+=t,e+="%"}}},getShowData(e,t){let a="",n="";switch(e){case i.TYPE_CONSTANT:a=this.caption,this.hasMultiplier||(n=void 0===this.attributes.constant_unit?"%":this.attributes.constant_unit);break;case i.TYPE_MULTIPLIER:a=this.caption,n="%";break;case i.TYPE_TOTAL:a=l()+tthis.caption,n="%"}return{title:a,value:t,tail:n}},createSimpleStat(e,t){return new r(this,e,t)}},r.prototype={show(){return this.base.show(this.type,this.value)},getShowData(){return this.base.getShowData(this.type,this.value)},statValue(e){return void 0!==e&&(this.value=e),this.value}},t.a=i},function(module,__webpack_exports__,__webpack_require__){"use strict";var _SkillElements_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),_main_module_LanguageSystem_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1),_strings_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2);function Lang(e){return Object(_main_module_LanguageSystem_js__WEBPACK_IMPORTED_MODULE_1__.a)("Skill Query/Analysis Skill/"+e)}const GLOBAL_EXTRA_ATTRIBUTE_VALUE={none:"@none"};function getStackBranchIdKey(e){return"id"+e.branchAttributes.id}function TempSkillEffect(){this.branchs=[],this.attributes={}}function TempSkillBranch(e){this.parent=e,this.branchAttributes={},this.stats=[],this.finish=!1}TempSkillEffect.prototype={from(e){return Object.getOwnPropertySymbols(e.attributes).forEach(function(t){this.appendAttribute(t,e.attributes[t])},this),e.branchs.forEach(function(e){this.newBranch().from(e)},this),this},newBranch(){const e=new TempSkillBranch(this);return this.branchs.push(e),e},overWrite:function(e){Object.getOwnPropertySymbols(e.attributes).forEach(function(t){const a=e.attributes[t];a==GLOBAL_EXTRA_ATTRIBUTE_VALUE.none&&this.attributes[t]?delete this.attributes[t]:this.appendAttribute(t,a)},this);e.branchs.map(e=>e.no);e.branchs.forEach(function(e,t){const a=this.branchs.findIndex(t=>t.no==e.no);-1==a?this.newBranch().from(e):this.branchs[a].overWrite(e)},this)},appendAttribute(e,t){return this.attributes[e]=t,this},checkData(){return 0!=this.branchs.length}},TempSkillBranch.prototype={from:function(e){return this.no=e.no,this.name=e.name,this.branchAttributes={},Object.keys(e.branchAttributes).forEach(function(t){this.appendBranchAttribute(t,e.branchAttributes[t])},this),e.stats.forEach(function(e){this.appendStat(e.base.baseName,e.value,"").type=e.type},this),this},appendBranchAttribute(e,t){return _SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.b.prototype.appendBranchAttribute.call(this,...arguments)},findLocation(){return _SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.b.prototype.findLocation.call(this)},appendStat(e,t,a){return _SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.b.prototype.appendStat.call(this,...arguments)},overWrite:function(e){if(""!=e.name)this.name!=e.name&&(this.name=e.name,_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.object.empty(this.branchAttributes)),Object.keys(e.branchAttributes).forEach(function(t,a){const n=e.branchAttributes[t];n==GLOBAL_EXTRA_ATTRIBUTE_VALUE.none&&this.branchAttributes[t]?delete this.branchAttributes[t]:this.appendBranchAttribute(t,n)},this),e.stats.forEach(function(e){let t=this.stats.find(t=>e.base===t.base&&e.type===t.type);void 0===t?this.appendStat(e.base.baseName,e.value,"").type=e.type:t.statValue(e.value)},this);else{const e=this.parent.branchs;e.splice(e.indexOf(this),1)}}};const GLOBAL_ICON_DATA={Sword:"",Staff:""},MAIN_WEAPON_TEXT_LIST=Lang("Main Weapon List"),SUB_WEAPON_TEXT_LIST=Lang("Sub Weapon List"),BODY_ARMOR_TEXT_LIST=Lang("Body Armor List"),simpleCreateHTML=_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.element.simpleCreateHTML;function createSkillAttributeScope(e,t,a,n){const l=simpleCreateHTML("div","skill_attribute");return null!==e&&l.appendChild(simpleCreateHTML("span","_icon",e)),null!==t&&l.appendChild(simpleCreateHTML("span","_title",t)),null!=a&&l.appendChild(simpleCreateHTML("span","_value",a)),null!=n&&l.appendChild(simpleCreateHTML("span","_tail",n)),l}function getEffectHTML(sef,attr_name,data){const safeEval=str=>{try{return eval(str)}catch(e){return console.warn(e),"?"}},ICON_DATA={[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.MP_COST]:"",[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.RANGE]:"",[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.SKILL_TYPE]:["","","",""],[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.DAMAGE_TYPE]:["",""],[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.PORATION_TYPE]:["",""],[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.IN_COMBO]:["","",""],[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.ACTION_TIME]:["","","","","","",""],[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.CASTING_TIME]:""},TITLE_DATA={[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.MP_COST]:Lang("mp cost"),[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.RANGE]:Lang("range"),[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.SKILL_TYPE]:Lang("skill type"),[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.DAMAGE_TYPE]:Lang("damage type"),[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.PORATION_TYPE]:Lang("poration type"),[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.IN_COMBO]:Lang("in combo"),[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.ACTION_TIME]:Lang("action time"),[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.CASTING_TIME]:["",Lang("casting time"),Lang("charging time")]},TEXT_LIST={[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.SKILL_TYPE]:Lang("skill type: List"),[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.DAMAGE_TYPE]:Lang("damage type: List"),[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.PORATION_TYPE]:Lang("poration type: List"),[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.IN_COMBO]:Lang("in combo: List"),[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.ACTION_TIME]:Lang("action time: List")},{SLv:SLv,CLv:CLv}=data;let title=TITLE_DATA[attr_name],v=sef.attributes[attr_name],tail=null;const icon=Array.isArray(ICON_DATA[attr_name])?ICON_DATA[attr_name][v]:ICON_DATA[attr_name];switch(attr_name){case _SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.CASTING_TIME:title=TITLE_DATA[attr_name][sef.attributes[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.SKILL_TYPE]],tail=Object(_main_module_LanguageSystem_js__WEBPACK_IMPORTED_MODULE_1__.a)("global/second");case _SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.MP_COST:v=safeEval(v);break;case _SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.RANGE:v="-"!=v?safeEval(v)+"m":Lang("range: no limit");break;case _SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.SKILL_TYPE:case _SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.IN_COMBO:case _SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.ACTION_TIME:v=TEXT_LIST[attr_name][v]}const he=document.createElement("div");he.className="skill_attribute";let res=`<span class="_icon">${icon}</span><span class="_title">${title}</span><span class="_value">${v}</span>`;return null!==tail&&(res+=`<span class="_tail">${tail}</span>`),he.innerHTML=res,he}const SUFFIX_LIST=["extra","poration"],EXTRA_FIX_LIST=["stack"];function getBranchHTML(branch,data){if(branch.finish)return null;function safeEval(str,dftv){try{return eval(str)}catch(e){return console.warn(e),void 0===dftv?"?":dftv}}function replaceExtraFormulaValue(e){const t={STR:Lang("skill formula: STR"),DEX:Lang("skill formula: DEX"),INT:Lang("skill formula: INT"),AGI:Lang("skill formula: AGI"),VIT:Lang("skill formula: VIT"),BSTR:Lang("skill formula: BSTR"),BDEX:Lang("skill formula: BDEX"),BINT:Lang("skill formula: BINT"),BAGI:Lang("skill formula: BAGI"),BVIT:Lang("skill formula: BVIT"),shield_refining:Lang("skill formula: shield_refining"),dagger_atk:Lang("skill formula: dagger_atk")};return Object.keys(t).forEach(a=>{e=e.replace(new RegExp(a,"g"),t[a])}),e=(e=e.replace(/\*/g,"×")).replace(/(\d+\.\d+)/,()=>100*parseFloat(RegExp.$1)+"%")}function processText(e,t){const a=e.branchAttributes;let n=a[void 0===t?"text":t];if(n=data.showOriginalFormula?n.replace(/\$\{([^\}]+)\}([%]?)/g,(...e)=>"%"!==e[2]?processValue(e[1],{light:!0,tail:"",separateText:!0}):processValue(e[1],{light:!0,tail:"%",separateText:!0})):safeEval("`"+(n=n.replace(/(\$\{[^\}]+\})([%]?)/g,(...e)=>"%"!==e[2]?processValue(e[1],{calc:!1,light:!0}):processValue(e[1],{calc:!1,tail:"%",light:!0})))+"`"),void 0!==a.mark&&a.mark.split(/\s*,\s*/).forEach(e=>{n=n.replace(new RegExp(e,"g"),lightText(e))}),void 0!==a.branch&&a.branch.split(/\s*,\s*/).forEach(e=>{n=n.replace(new RegExp(e,"g"),lightText(e))}),void 0!==a.skill){const e=data.skillRoot.controller,t=data.skillRoot;a.skill.split(/\s*,\s*/).forEach(a=>{n=n.replace(new RegExp(a,"g"),a=>{const n=t.findSkillByName(a);if(void 0===n)return a;const l=simpleCreateHTML("span","skill_from_where_button");return l.appendChild(simpleCreateHTML("span","skill_name",a)),l.setAttribute(Object(_strings_js__WEBPACK_IMPORTED_MODULE_3__.a)().data_skillElementNo,e.getSkillElementNoStr(n)),l.outerHTML})})}return void 0!==a.skill_tree&&a.skill_tree.split(/\s*,\s*/).forEach(e=>{n=n.replace(new RegExp(e,"g"),lightText(e))}),n}function processValue(e,t){let a;e=e.split(",,"),t=Object.assign({calc:!0,tail:"",head:"",preText:"",toPercentage:!1,checkHasStack:e[0],light:!1,separateText:!1},t),e.forEach((e,n)=>{if(0===n)if(data.showOriginalFormula)e=(e=(e=(e=(e=e.replace(/CLv/g,Lang("character level"))).replace(/SLv/g,Lang("skill level"))).replace(/\*/g,"×")).replace(/stack\[(\d+)\]/g,()=>stack_name_list[parseInt(RegExp.$1,10)])).replace(/stack[\[]{0}/g,()=>stack_name_list[0]),a=e;else{if(t.calc){let n=safeEval(e);t.toPercentage&&(n*=100),void 0===n||Number.isInteger(n)||(n=n.toFixed(2)),a=n}else a=e;t.toPercentage&&(a+="%")}else e=replaceExtraFormulaValue(e),a+="-"!==e.charAt(0)?"+"+e:e}),a=t.preText+a,(t.separateText||(1!==e.length||!e[0].match(/^[\d\.]+$/))&&data.showOriginalFormula)&&(a='<span class="separate_text">'+a+"</span>"),a=t.head+a,a+=t.tail;const n=document.createElement("span");return t.checkHasStack.includes("stack")?n.classList.add("effect_by_stack"):t.light&&n.classList.add("light"),n.innerHTML=a,n.outerHTML}function processStat(e){const t=e.getShowData(),a=t.value.split(",,"),n=1===a.length&&safeEval(a[0])<0?"":"+",l={tail:t.tail,head:t.title+n};1!==a.length&&(l.separateText=!0);let i=processValue(t.value,l);return""===n&&(i=darkText(i)),createSkillAttributeScope(null,null,i)}function lightText(e){return'<span class="light">'+e+"</span>"}function darkText(e){return'<span class="dark">'+e+"</span>"}function markText(e){return lightText(e)}function getPorationHTML(e){const t=e.branchAttributes,a={physical:Lang("physical"),magic:Lang("magic"),normal_attack:Lang("normal attack"),none:Lang("damage poration type: none")},n=Object.assign({},a,{auto:a[t.damage],none:Lang("effective poration type: none")});return{one:createSkillAttributeScope(null,Lang("damage poration: title"),a[t.damage]),two:createSkillAttributeScope(null,Lang("effective poration: title"),n[t.poration])}}function getDamageElementHTML(e){const t={neutral:Lang("element: neutral"),fire:Lang("element: fire"),water:Lang("element: water"),earth:Lang("element: earth"),wind:Lang("element: wind"),light:Lang("element: light"),dark:Lang("element: dark"),arrow:Lang("element: arrow"),one_hand_sword:Lang("element: one hand sword")},a=simpleCreateHTML("div","skill_attribute");return"arrow"!=e&&a.appendChild(simpleCreateHTML("span",["_icon","element_"+e,"element_ball"])),a.appendChild(simpleCreateHTML("span",["_value","element_value"],t[e])),a}function createContentLine(e,t,a){const n=simpleCreateHTML("div",["content","content_line"]),l=simpleCreateHTML("div","scope1"),i=simpleCreateHTML("div","scope2");return l.appendChild(e),i.appendChild(t),n.appendChild(l),n.appendChild(i),null!=a&&(Array.isArray(a)?[...a].forEach(e=>n.appendChild(e)):n.appendChild(a)),n}function getTargetText(e,t){const a={self:Lang("target type: self"),party:Lang(t?"target type: party & is place":"target type: party"),aura:Lang("target type: aura"),target:Lang("target type: target"),none:null}[e];return a}function getEffectiveAreaHTML(e){const t=e.branchAttributes,a="self"===t.end_position,n=simpleCreateHTML("div","scope1");{const e=simpleCreateHTML("div","skill_attribute");if(e.appendChild(simpleCreateHTML("span",["_icon","element_ball","ball_character"])),e.appendChild(simpleCreateHTML("span","_value",Lang("effective area: character position"))),n.appendChild(e),!a){const e=simpleCreateHTML("div","skill_attribute");e.appendChild(simpleCreateHTML("span",["_icon","element_ball","ball_target"])),e.appendChild(simpleCreateHTML("span","_value",Lang("effective area: target position"))),n.appendChild(e)}}let l,i,r;["radius","angle","effective_area","move_distance"].forEach(e=>{if(t[e]){let a,s=t[e];switch(e){case"radius":a=Lang("radius"),l=safeEval(s),s=processValue(s,{tail:"m"});break;case"angle":a=Lang("sector: angle"),i=safeEval(s),s=processValue(s,{tail:"°"});break;case"effective_area":r=t[e],a=Lang("effective area: title"),s={circle:Lang("effective area type: circle"),line:Lang("effective area type: line"),sector:Lang("effective area type: sector")}[s];break;case"move_distance":a=Lang("move distanve: title"),s=processValue(s,{tail:"m"})}n.appendChild(createSkillAttributeScope(null,a,s))}});const s=document.createDocumentFragment(),c=e=>void 0!==e?10*e:10;let o,d,p,u,_,h;const m="#ff5fb7",E=void 0===t.move_distance?8:12;switch(r){case"line":case"circle":switch(d=c(a?2*l+2:2*l+E+2),o=c(2*l+2),p=c(l+1),u=o/2,_=a?p:p+c(8),h=u,r){case"circle":{const e=_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.drawCircle(_,h,c(l),{fill:"#feeaf5"});s.appendChild(e);const t=_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.drawCircle(_,h,c(l),{stroke:"#FFD1EA",fill:"none"});t.appendChild(_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.createAnimate("stroke",{values:"#FFD1EA;#ff5fb7;#ff5fb7",keyTimes:"0;0.2;1",dur:"2.5s"})),s.appendChild(t)}break;case"line":{const e=p+c(E),t=_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.drawPath(`M${p} ${u-c(l)} A${c(l)} ${c(l)} 0 0 0 ${p} ${u+c(l)} L${e} ${u+c(l)} A${c(l)} ${c(l)} 0 0 0 ${e} ${h-c(l)} Z`,{fill:"#feeaf5"});s.appendChild(t);const a=_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.drawCircle(p,u,c(l),{stroke:"#FFD1EA",fill:"none"});a.appendChild(_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.createAnimate("stroke",{id:"a1",values:"#FFD1EA;#ff5fb7;#ff5fb7",keyTimes:"0;0.2;1",dur:"1s",repeatCount:"1",begin:"0s;a2.end",fill:"freeze"})),a.appendChild(_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.createAnimate("cx",{id:"a2",values:`${p};${e};${e}`,keyTimes:"0;0.2;1",dur:"1.5s",repeatCount:"1",begin:"a1.end"})),s.appendChild(a)}}break;case"sector":{d=c(E+6),u=(o=c(E)*Math.sin(i*Math.PI/180)+c(2))/2,_=(p=c(4))+c(8),h=u;const e=0,t=2;l=2;const a=_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.drawSector(p,u,c(e),c(E),i/2,360-i/2,1,{fill:"#feeaf5"});s.appendChild(a);const n=_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.drawSector(p,u,c(e),c(e+1),i/2,360-i/2,1,{stroke:m});n.appendChild(_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.createAnimate("d",{id:"a1",to:_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.getSectorD(p,u,c(E-t),c(E),i/2,360-i/2,1),dur:"0.4s",repeatCount:1,begin:"0s;a2.end",fill:"freeze"})),n.appendChild(_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.createAnimate("stroke",{id:"a2",to:m,dur:"2s",repeatCount:1,begin:"a1.end"})),s.appendChild(n)}}const f=_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.drawCircle(p,u,c(l<=.5&&a?.25:.5),{fill:m});if("1"===t.is_sprint&&f.appendChild(_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.createAnimate("cx",{values:`${p};${p+c(E)};${p+c(E)}`,keyTimes:"0;0.2;1",dur:"1.5s",repeatCount:"1",begin:"a1.end"})),s.appendChild(f),!a){const e=_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.drawCircle(_,h,c(l>.5?.5:.25),{fill:"#2196f3"});s.appendChild(e)}const b=_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.svg.create(d,o);b.appendChild(s);const g=simpleCreateHTML("div",["effective_area","content","hidden"]),L=document.createElement("div");return L.appendChild(b),g.appendChild(L),g.appendChild(n),g}const{SLv:SLv,CLv:CLv}=data,btype=branch.name,suffix=[];let attr=branch.branchAttributes,p=branch.findLocation()+1,c=branch.parent.branchs[p];for(;void 0!==c&&-1!=SUFFIX_LIST.indexOf(c.name);)suffix.push(c),c=branch.parent.branchs[++p];const extra_fix=branch.parent.branchs.filter(e=>-1!=EXTRA_FIX_LIST.indexOf(e.name)),stack_branch_list=extra_fix.filter(e=>"stack"==e.name&&-1!=(attr.stack_id||"").split(",").indexOf(e.branchAttributes.id)),stack_value_list=stack_branch_list.map(e=>safeEval(data.stackValues[getStackBranchIdKey(e)])),stack_name_list=stack_branch_list.map(e=>data.stackNames[getStackBranchIdKey(e)]||Lang("branch/stack/base name")+e.branchAttributes.id),stack=stack_value_list.length>1?stack_value_list:stack_value_list[0];switch(btype){case"stack":{const e=branch,t=simpleCreateHTML("span","ctr_button",'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M18 13H6c-.55 0-1-.45-1-1s.45-1 1-1h12c.55 0 1 .45 1 1s-.45 1-1 1z"/></svg>'),a=simpleCreateHTML("span","ctr_button",'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M18 13h-5v5c0 .55-.45 1-1 1s-1-.45-1-1v-5H6c-.55 0-1-.45-1-1s.45-1 1-1h5V6c0-.55.45-1 1-1s1 .45 1 1v5h5c.55 0 1 .45 1 1s-.45 1-1 1z"/></svg>'),n=simpleCreateHTML("input","mid"),l=void 0!==e.branchAttributes.unit?simpleCreateHTML("span","unit",e.branchAttributes.unit):null,i=data.stackValues[getStackBranchIdKey(branch)];n.value=i,null===l?(n.style.width="2rem",n.style.textAlign="center"):n.style.width=.6*String(i).length+.2+"rem";const r=parseInt(safeEval(e.branchAttributes.max),10),s=parseInt(safeEval(e.branchAttributes.min),10),c=function(t){const a=parseInt(n.getAttribute("data-maxv"),10),l=parseInt(n.getAttribute("data-minv"),10);let i=parseInt(n.value,10);switch(this.getAttribute("data-ctr")){case"-":--i;break;case"+":++i}i>a?i=a:i<l&&(i=l),i=String(i),n.value=i,data.stackValues[getStackBranchIdKey(e)]=i,data.skillRoot.controller.updateSkillHTML()};t.setAttribute("data-ctr","-"),t.addEventListener("click",c),a.setAttribute("data-ctr","+"),a.addEventListener("click",c),n.type="number",n.setAttribute("data-maxv",r),n.setAttribute("data-minv",s),n.addEventListener("change",c),n.addEventListener("focus",function(e){this.select()});const o=document.createDocumentFragment();void 0!==attr.name&&o.appendChild(simpleCreateHTML("span","_main_title",attr.name)),o.appendChild(createSkillAttributeScope(null,Lang("branch/stack/min value"),processValue(attr.min))),void 0!==attr.max&&o.appendChild(createSkillAttributeScope(null,Lang("branch/stack/max value"),processValue(attr.max)));const d=document.createDocumentFragment();d.appendChild(t),d.appendChild(n),null!==l&&d.appendChild(l),d.appendChild(a);const p=createContentLine(o,d),u=simpleCreateHTML("div",["branch","branch_"+btype]);return u.appendChild(p),branch.finish=!0,u}case"poration":{const e=simpleCreateHTML("div",["branch","branch_"+btype]),t=simpleCreateHTML("div","content"),{one:a,two:n}=getPorationHTML(branch);return t.appendChild(a),t.appendChild(n),e.appendChild(t),branch.finish=!0,e}case"damage":{let e=null;void 0!==attr.name&&(e=simpleCreateHTML("span","_name",attr.name));let t="";switch(attr.title){case"normal":t="1"==attr.frequency?Lang("branch/damage/title type: one"):Lang("branch/damage/title type: total");break;case"each":t=Lang("branch/damage/title type: each");break;case"normal_attack":t=Lang("branch/damage/title type: normal attack")}const a=simpleCreateHTML("span","_main_title",t),n=createSkillAttributeScope(null,null,"physical"==attr.damage_type?Lang("branch/damage/valid base: atk"):Lang("branch/damage/valid base: matk")),l=createSkillAttributeScope(null,null,{physical:Lang("physical"),magic:Lang("magic")}[attr.damage_type]),i="normal_attack"===attr.title&&"0"===attr.constant?null:createSkillAttributeScope(null,Lang("branch/damage/skill constant"),processValue(attr.constant)),r=createSkillAttributeScope(null,Lang("branch/damage/skill multiplier"),processValue(attr.multiplier),"%");let s=null;if(void 0!==attr.aliment_name){const e=document.createDocumentFragment();e.appendChild(createSkillAttributeScope(null,null,attr.aliment_name)),e.appendChild(createSkillAttributeScope(null,Lang("branch/damage/chance"),processValue(attr.aliment_chance||"0")+"%")),s=createContentLine(simpleCreateHTML("span","_main_title",Lang("branch/damage/aliment")),e)}let c=null,o=null;"single"==attr.type?o=createSkillAttributeScope(null,null,Lang("branch/damage/target type: single")):(o=createSkillAttributeScope('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>',null,Lang("branch/damage/target type: AOE")),c=getEffectiveAreaHTML(branch),o.addEventListener("click",()=>{c.classList.toggle("hidden")}),o.classList.add("show_area"));let d=null;void 0!==attr.element&&(d=getDamageElementHTML(attr.element));let p=null;"1"==attr.is_place&&(p=createSkillAttributeScope(null,null,Lang("branch/damage/is place")));let u=null,_=null,h=null;(parseInt(attr.frequency)>1||"each"==attr.title)&&(u=createSkillAttributeScope(null,Lang("branch/damage/frequency"),processValue(attr.frequency)),t="common"==attr.judgment?Lang("branch/damage/judgment: common"):Lang("branch/damage/judgment: separate"),_=createSkillAttributeScope(null,null,t),"1"==attr.is_place&&void 0!==attr.cycle&&(h=createSkillAttributeScope(null,null,Lang("branch/damage/cycle: preText")+processValue(attr.cycle,{tail:Object(_main_module_LanguageSystem_js__WEBPACK_IMPORTED_MODULE_1__.a)("global/second")}))));const m=suffix.find(e=>"poration"==e.name);let E=null,f=null;if(void 0!==m){const{one:e,two:t}=getPorationHTML(m);E=e,f=t,m.finish=!0}const b=suffix.filter(e=>"extra"==e.name),g=document.createDocumentFragment();b.forEach(e=>{const t=e.branchAttributes;void 0===t.condition&&(t.condition=Lang("branch/damage/extra/base title"));const a=document.createDocumentFragment();if(t.aliment_name&&a.appendChild(createSkillAttributeScope(null,null,t.aliment_name)),t.aliment_chance&&a.appendChild(createSkillAttributeScope(null,Lang("branch/damage/chance"),processValue(t.aliment_chance)+"%")),t.constant){let e=safeEval(t.constant);const n=e>=0?"+":"";let l=Lang("branch/damage/skill constant")+n+e;e<0&&(l=darkText(l)),l=processValue(l,{calc:!1,checkHasStack:t.constant}),a.appendChild(createSkillAttributeScope(null,null,l))}t.element&&a.appendChild(getDamageElementHTML(t.element)),t.caption&&a.appendChild(simpleCreateHTML("div","text_scope",processText(e,"caption"))),e.stats.forEach(e=>a.appendChild(processStat(e))),g.appendChild(createContentLine(simpleCreateHTML("span","_main_title",processText(e,"condition")),a)),e.finish=!0});const L=simpleCreateHTML("div","top");null!==e&&L.appendChild(e);const T=document.createDocumentFragment();T.appendChild(l),T.appendChild(o),null!==p&&T.appendChild(p),null!==d&&T.appendChild(d),null!==_&&T.appendChild(_),null!==u&&T.appendChild(u),null!==h&&T.appendChild(h),null!==E&&T.appendChild(E),null!=f&&T.appendChild(f);const k=document.createDocumentFragment();k.appendChild(n),null!==i&&k.appendChild(i),k.appendChild(r);const C=simpleCreateHTML("div","content"),S=simpleCreateHTML("div","scope1"),v=simpleCreateHTML("div","scope2");let M=null;"normal_attack"===attr.title?M=createContentLine(a,k):(S.appendChild(a),v.appendChild(k)),S.appendChild(T),0!==S.childElementCount&&C.appendChild(S),0!==v.childElementCount&&C.appendChild(v);const A=simpleCreateHTML("div",["branch","branch_"+btype]);return 0!=L.childElementCount&&A.appendChild(L),A.appendChild(C),null!==M&&A.appendChild(M),null!==s&&A.appendChild(s),g.childElementCount>0&&A.appendChild(g),null!==c&&A.appendChild(c),branch.finish=!0,A}case"effect":case"next":case"passive":{let e=null;attr.name&&(e=simpleCreateHTML("span","_name",attr.name));let t=attr.condition;if("auto"==t&&(t=Lang("branch/effect/condition: auto")),"hit"==t&&(t=Lang("branch/effect/condition: hit")),"next"==btype)if("1"==attr.frequency)t=Lang("branch/effect/condition: next");else{const e=Lang("branch/effect/condition: next-2");t=`${e[0]}${attr.frequency}${e[1]}`}"passive"==btype&&(t=Lang("branch/effect/condition: passive")),attr.condition=t;const a="none"!=t?simpleCreateHTML("span","_main_title",processText(branch,"condition")):null;let n=null;attr.end_condition&&(n=simpleCreateHTML("span","_main_title",attr.end_condition));let l=null;if(attr.duration){let e=processValue(attr.duration);if("1"===attr.is_place)l=createSkillAttributeScope(null,Lang("branch/effect/duration"),processValue(attr.duration),Object(_main_module_LanguageSystem_js__WEBPACK_IMPORTED_MODULE_1__.a)("global/second"));else{const t=Lang("branch/effect/duration-2");l=simpleCreateHTML("span","_main_title",`${t[0]}${e}${t[1]}`)}}let i=null;"1"===attr.is_place&&(i=createSkillAttributeScope(null,null,Lang("branch/damage/is place")));let r=void 0!==attr.type?getTargetText(attr.type,"1"===attr.is_place):null,s=null,c=null;void 0===attr.radius?s=null!==r?createSkillAttributeScope(null,null,r):null:(s=createSkillAttributeScope('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>',null,r),attr.end_position="self",attr.effective_area="circle",c=getEffectiveAreaHTML(branch),s.addEventListener("click",()=>{c.classList.toggle("hidden")}),s.classList.add("show_area"));const o=suffix.filter(e=>"extra"==e.name),d=document.createDocumentFragment();o.forEach(e=>{const t=e.branchAttributes;void 0===t.condition&&(t.condition=Lang("branch/damage/extra/base title"));const a=document.createDocumentFragment();t.caption&&a.appendChild(simpleCreateHTML("div","text_scope",processText(e,"caption"))),e.stats.forEach(e=>a.appendChild(processStat(e)));const n=document.createDocumentFragment();n.appendChild(simpleCreateHTML("span","_main_title",processText(e,"condition"))),void 0!==t.target&&n.appendChild(simpleCreateHTML("span","_main_title",t.target)),d.appendChild(createContentLine(n,a)),e.finish=!0});const p=document.createDocumentFragment();null!==a&&p.appendChild(a),null!==i&&p.appendChild(i),null!==n&&p.appendChild(n),null!==l&&p.appendChild(l),null!=s&&p.appendChild(s);const u=document.createDocumentFragment();attr.caption?u.appendChild(simpleCreateHTML("div","text_scope",processText(branch,"caption"))):branch.stats.forEach(e=>u.appendChild(processStat(e)));const _=simpleCreateHTML("div","top");null!==e&&_.appendChild(e);const h=simpleCreateHTML("div",["branch","branch_"+btype]);0!=_.childElementCount&&h.appendChild(_);const m=createContentLine(p,u);return null!==i&&m.classList.remove("content_line"),h.appendChild(m),0!==d.childElementCount&&h.appendChild(d),null!==c&&h.appendChild(c),branch.finish=!0,h}case"heal":{let e=null;attr.name&&(e=simpleCreateHTML("span","_name",attr.name));let t=getTargetText(attr.target);const a=null!=t?createSkillAttributeScope(null,null,t):null,n="0"!=attr.constant?createSkillAttributeScope(null,null,processValue(attr.constant)):null;let l=null;if(void 0!==attr.duration){let e=processValue(attr.duration);l=createSkillAttributeScope(null,Lang("branch/effect/duration"),processValue(attr.duration),Object(_main_module_LanguageSystem_js__WEBPACK_IMPORTED_MODULE_1__.a)("global/second"))}let i=null;void 0!==attr.frequency&&(i=createSkillAttributeScope(null,Lang("branch/heal/frequency"),processValue(attr.frequency)));let r=null;void 0!==attr.cycle&&(r=createSkillAttributeScope(null,null,Lang("branch/damage/cycle: preText")+processValue(attr.cycle,{tail:Object(_main_module_LanguageSystem_js__WEBPACK_IMPORTED_MODULE_1__.a)("global/second")})));const s=document.createDocumentFragment();if(void 0!==attr.extra_text){const e=attr.extra_text.split(","),t=attr.extra_value.split(",").map(e=>processValue(e,{toPercentage:!0}));e.forEach((e,a)=>{s.appendChild(createSkillAttributeScope(null,e,t[a]))})}const c=simpleCreateHTML("div","top");null!==e&&c.appendChild(e);const o=simpleCreateHTML("div",["branch","branch_"+btype]);0!=c.childElementCount&&o.appendChild(c);const d=simpleCreateHTML("div","content"),p=simpleCreateHTML("div","scope1");p.appendChild(a),null!==l&&p.appendChild(l),null!==i&&p.appendChild(i),null!==r&&p.appendChild(r),d.appendChild(p),o.appendChild(d);const u=document.createDocumentFragment();return null!==n&&u.appendChild(n),0!==s.childElementCount&&u.appendChild(s),o.appendChild(createContentLine(simpleCreateHTML("span","_main_title",{hp:Lang("branch/heal/title: hp"),mp:Lang("branch/heal/title: mp")}[attr.type]),u)),branch.finish=!0,o}case"text":case"tips":{let e=null;attr.name&&(e=simpleCreateHTML("span","_name",attr.name));const t=simpleCreateHTML("div","text_scope",processText(branch)),a=simpleCreateHTML("div",["branch","branch_"+btype]),n=simpleCreateHTML("div","top");null!==e&&n.appendChild(e);const l=simpleCreateHTML("div","content");return l.appendChild(t),0!=n.childElementCount&&a.appendChild(n),a.appendChild(l),branch.finish=!0,a}case"list":{const e=[];e.push(branch);let t=branch.findLocation()+1,a=branch.parent.branchs[t];for(;void 0!==a&&a.name==btype;)e.push(a),a=branch.parent.branchs[++t];const n=simpleCreateHTML("ul","_lists");e.forEach(e=>{n.appendChild(simpleCreateHTML("li",null,processText(e))),e.finish=!0});const l=simpleCreateHTML("div",["branch","branch_"+btype]),i=simpleCreateHTML("div","content");return i.appendChild(n),l.appendChild(i),branch.finish=!0,l}case"reference":{let e=null;attr.text&&(e=simpleCreateHTML("div","text_scope",processText(branch)));let t=null;if(attr.url){t=document.createDocumentFragment();let e=attr.url.split(","),a=attr.url_text.split(",");e.forEach((e,n)=>{t.appendChild(createSkillAttributeScope(null,null,`<a href="${e}" target="_blank" class="url_text">${a[n]}</a>`))})}const a=simpleCreateHTML("div",["branch","branch_"+btype]);return null!==e&&a.appendChild(e),null!==t&&a.appendChild(createContentLine(simpleCreateHTML("span","_main_title",Lang("branch/reference/reference url")),t)),branch.finish=!0,a}}return null}function beforeExport(e,t){const a=t.skillRoot.controller,n=function(e){const t=a.currentData.skill_from_where_scope;_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.element.removeAllChild(t),t.classList.remove("hidden");let n=this.querySelector("div.temp");n||(n=simpleCreateHTML("div","temp"),this.appendChild(n)),n.appendChild(t);const l=_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.element.convertRemToPixels(1),i=this.getBoundingClientRect(),r=t.getBoundingClientRect();let s=i.left,c=i.top,o=r.width,d=window.innerWidth,p=r.height,u=window.innerHeight;s+r.width>d-l?t.style.left=(d-1*o-s)/l-.5+"rem":s<r.width?t.style.left=-1*s/l+.5+"rem":t.style.left="0",t.style.top=c>u/2?-1*p/l-.5+"rem":i.height/l+.5+"rem";const _=a.selectSkillElement(this.getAttribute(Object(_strings_js__WEBPACK_IMPORTED_MODULE_3__.a)().data_skillElementNo));t.appendChild(createSkillAttributeScope(null,Object(_main_module_LanguageSystem_js__WEBPACK_IMPORTED_MODULE_1__.a)("Skill Query/Skill Element/skill tree: from"),_.parent.name));const h=simpleCreateHTML("div","button_scope"),m=simpleCreateHTML("span","global_button_1",Object(_main_module_LanguageSystem_js__WEBPACK_IMPORTED_MODULE_1__.a)("global/cancel"));m.addEventListener("click",function(e){this.parentNode.parentNode.classList.add("hidden"),e.stopPropagation()});const E=simpleCreateHTML("span","global_button_1",Lang("button text/to skill"));E.addEventListener("click",function(e){this.parentNode.parentNode.classList.add("hidden"),a.skillRecord(_),e.stopPropagation()}),h.appendChild(m),h.appendChild(E),t.appendChild(h)};function l(e){this.parentNode.querySelector("div.scope1").classList.toggle("hidden"),this.querySelector(".open").classList.toggle("hidden"),this.querySelector(".close").classList.toggle("hidden")}e.querySelectorAll("span.skill_from_where_button").forEach(e=>e.addEventListener("click",n)),e.querySelectorAll("div.content > div.scope1").forEach(e=>{if(e.parentNode.classList.contains("content_line")||0===e.childElementCount)return;const t=simpleCreateHTML("span","hidden_toggle_button",'<span class="close hidden"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg></span><span class="open"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M8.12 14.71L12 10.83l3.88 3.88c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L12.7 8.71c-.39-.39-1.02-.39-1.41 0L6.7 13.3c-.39.39-.39 1.02 0 1.41.39.38 1.03.39 1.42 0z"/></svg></span>');t.addEventListener("click",l),e.parentNode.insertBefore(t,e.parentNode.firstChild),t.click()})}__webpack_exports__.a=function(e){const t=e.currentSkill,a=e.skillLevel,n=e.characterLevel;let l=(new TempSkillEffect).from(t.defaultEffect),i=!1;if(t.effects.forEach(function(a){if(!i)return e.skillRoot.controller.equipmentCheck(a,e)?(a!=t.defaultEffect&&l.overWrite(a),void(i=!0)):void 0}),i){const t=document.createDocumentFragment(),i=[_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.MP_COST,_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.RANGE,_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.SKILL_TYPE,_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.DAMAGE_TYPE,_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.PORATION_TYPE,_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.IN_COMBO,_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.ACTION_TIME,_SkillElements_js__WEBPACK_IMPORTED_MODULE_0__.c.CASTING_TIME],r=document.createElement("div");r.className="skill_attributes",i.forEach(function(e){if(void 0===l.attributes[e])return;const t=getEffectHTML(l,e,{SLv:a,CLv:n});t&&r.appendChild(t)}),t.appendChild(r);const s=document.createElement("div");if(s.className="skill_branchs",l.checkData()){null===e.stackValues&&(e.stackValues={},_main_module_cyteria_js__WEBPACK_IMPORTED_MODULE_2__.a.object.empty(e.stackNames),l.branchs.forEach(t=>{if("stack"==t.name){const a=t.branchAttributes,n="auto"==a.default?a.min:a.default;e.stackValues[getStackBranchIdKey(t)]=n,e.stackNames[getStackBranchIdKey(t)]=t.branchAttributes.name}}));const t=e.stackValues,i=e.stackNames,r=e.showOriginalFormula,c=e.skillRoot;l.branchs.forEach(e=>{const l=getBranchHTML(e,{SLv:a,CLv:n,stackNames:i,stackValues:t,showOriginalFormula:r,skillRoot:c});null!==l&&s.appendChild(l)})}else{const e=document.createElement("div");e.classList.add("no_data"),e.innerHTML=Lang("no data"),s.appendChild(e)}return t.appendChild(s),beforeExport(t,e),t}{const e=document.createElement("div");return e.classList.add("no_data"),e.innerHTML=Lang("equipment not confirm"),e}}},function(e,t,a){e.exports=a(8)},function(e,t,a){"use strict";a.r(t);var n=a(4),l=a(0);const i=0,r=1,s=1,c=2,o="預設",d=3,p=4,u=5,_=["單手劍","雙手劍","弓","弩","法杖","魔導具","拳套","旋風槍","拔刀劍","雙劍"],h=["箭矢","盾牌","小刀","魔導具","拳套","拔刀劍"],m=["輕量化","重量化","一般"],E=6,f=7,b=8,g=9,L=10,T=11,k=12,C=13,S=14,v=15,M=16,A=["瞬發","須詠唱","須蓄力","被動"],y=["可以放入連擊","無法放入連擊","不可放入連擊的第一招"],O=["極慢","慢","稍慢","一般","稍快","快","極快"],P="Skill Tree Category",w=2,D="Skill Tree",I=2;var B=function(e){e.skillTreeCategorys.forEach(e=>{e.skillTrees.forEach(e=>{e.skills.forEach(e=>{const t=e.defaultEffect;if(t){if(void 0!==e.effects.find(e=>0===e.mainWeapon)){void 0===e.effects.find(e=>9===e.mainWeapon)&&e.newElement(l.c.TYPE,{mainWeapon:9,subWeapon:-1,bodyArmor:-1})}t.branchs.forEach(e=>{!function(e){const t=function(e,t){Object.keys(t).forEach(a=>{void 0===e.branchAttributes[a]&&e.appendBranchAttribute(a,t[a])})};switch(e.name){case"damage":t(e,{constant:"0",multiplier:"0",type:"single",base:"auto",frequency:"1",end_position:"target",effective_area:"circle",title:"normal",judgment:"common",damage_type:"physical"});break;case"stack":t(e,{min:"1",default:"auto"});break;case"effect":case"hit":t(e,{type:"self",condition:"auto"});break;case"heal":t(e,{target:"self",frequency:"1",constant:"0"});break;case"next":t(e,{type:"none",frequency:"1"});break;case"poration":t(e,{poration:"auto"});break;case"passive":case"text":case"tips":case"list":case"head":case"extra":case"reference":case"":break;default:console.warn("Unknow Skill Branch Name."),console.log(e)}}(e)})}})})})};function H(){this.skillRoot=new l.d(this)}H.prototype={init(){const e=this;return new Promise((t,a)=>{Papa.parse("https://docs.google.com/spreadsheets/d/e/2PACX-1vS_XhF85gZ5sd9AtOMSM6JY4OuQwFlD6kToQynQ4bMq_fiaUNr26c7dbrIs6WeWnscKe1rau1npWYe7/pub?gid=170573319&single=true&output=csv",{download:!0,complete(a){!function(e,t){let a=null;const B=[l.f.TYPE,l.e.TYPE,l.a.TYPE,l.c.TYPE,l.b.TYPE],H=function(e,t){if(B.indexOf(e.TYPE)<=B.indexOf(t))return e;for(;e.TYPE!=t;)e=e.parent;return e},x=function(e,t){return e===t?null:e};t.forEach(function(t,R){try{if(0==R)return;const j=t[i];if(""!=j){const n=t[r];switch(n){case P:{const n=t[w];a=e.newElement(l.f.TYPE,{no:j,name:n})}break;case D:{a=H(a,l.f.TYPE);const e=t[I];a=a.newElement(l.e.TYPE,{no:j,name:e})}break;default:if(""!=n){a=H(a,l.e.TYPE);const e=t[s];a=a.newElement(l.a.TYPE,{no:j,name:e})}case"":{const e=_.indexOf(t[d]),n=h.indexOf(t[p]),i=m.indexOf(t[u]),r=t[c];if(""==r)return;const s=(a=H(a,l.a.TYPE)).newElement(l.c.TYPE,{mainWeapon:e,subWeapon:n,bodyArmor:i});r==o&&a.setDefaultEffect(s),a=s.appendAttribute(l.c.MP_COST,x(t[T],"")).appendAttribute(l.c.RANGE,x(t[k],"")).appendAttribute(l.c.SKILL_TYPE,x(A.indexOf(t[C]),-1)).appendAttribute(l.c.IN_COMBO,x(y.indexOf(t[S]),-1)).appendAttribute(l.c.ACTION_TIME,x(O.indexOf(t[v]),-1)).appendAttribute(l.c.CASTING_TIME,x(t[M],""))}}}if(B.indexOf(a.TYPE)<B.indexOf(l.c.TYPE))return;const N=t[E];if(""!=N){a=H(a,l.c.TYPE);const e=t[f];a=a.newElement(l.b.TYPE,{no:N,name:e})}const W=t[b],Y=t[g];""!=W&&(n.a.CharacterSystem.findStatBase(W)?a.appendStat(W,Y,t[L]):a.appendBranchAttribute(W,Y))}catch(e){console.warn("[Error] When Load Skill Data"),console.log(t)}})}(e.skillRoot,a.data),B(e.skillRoot),t()},error(e){console.warn("讀取技能資料時發生錯誤"),console.log(e),a()}})})},init_SkillQuery(e){this.skillRoot.controller.initSkillQueryHTML(e)}};var x=H;var R=a(5);function j(){this.statList=[]}j.prototype={init(){},init_statList(){const e=this;return new Promise((t,a)=>{Papa.parse("./src/CharacterSystem/module/other/BaseStatData.csv",{download:!0,complete(a){var n;n=e,a.data.forEach(function(e,t){if(0==t)return;const a=""===e[3]?null:"@none"==e[3]?"":e[3];n.appendStatBase(e[0],e[1],"無"!=e[2]).appendAttribute("constant_unit",a)}),t()},error(e){console.warn("讀取角色能力資料時發生錯誤"),console.log(e),a()}})})},appendStatBase(e,t,a,n){const l=new R.a(e,t,a);return this.statList.push(l),l},StatList(){return this.statList},findStatBase(e){return this.StatList().find(t=>t.baseName==e)}};var N=j;const W="data-langtext";function Y(e){const t=function(e){const t=Array.from(this.parentNode.getElementsByTagName("li")).indexOf(this),a=document.querySelector('*[data-main-scope="1"]');a.setAttribute("data-main-scope",0),a.classList.add("hidden");let n=document.querySelectorAll("*[data-main-scope]")[t];n.setAttribute("data-main-scope",1),n.classList.remove("hidden")},a=document.createDocumentFragment();["Skills Information|,|技能資料|,|スキルインフォ"].forEach(e=>{const n=document.createElement("li");n.innerHTML=function(e,t={}){if(null==e)return"";const a=document.createElement("a");return a.setAttribute(W,e),t.href&&(a.href=t.href),t.class&&(Array.isArray(t.class)?a.classList.add(...t.class):a.classList.add(t.class)),a.outerHTML}(e),n.addEventListener("click",t),a.appendChild(n)});const n=document.createElement("ul");n.appendChild(a),e.appendChild(n)}var U=function(e){const{top_menu:t}=e;Y(t),function e(t){const a=t.querySelectorAll(`a[${W}], input[${W}]`);0!==a.length&&Array.from(a).forEach(t=>{t.innerHTML=function(e){let t=e.split("|,|");return t[1]||t[0]}(t.getAttribute(W)),e(t)})}(document),document.getElementById("LoadingPage").classList.add("hidden")};function K(e){const t=document.createElement("div");t.innerHTML=e,document.querySelector("div#LoadingPage > div.msg").appendChild(t)}function V(e){return new Promise((t,a)=>{const n=document.createElement("div");n.innerHTML=e,document.querySelector("div#LoadingPage > div.msg").appendChild(n),t()})}if("0"===document.getElementById("SkillQuery").getAttribute("data-ready"))try{!async function(){n.a.SkillSystem=new x,n.a.CharacterSystem=new N,await V("載入角色能力清單..."),await n.a.CharacterSystem.init_statList().catch(()=>K("...載入失敗。")),await V("載入技能清單..."),await n.a.SkillSystem.init().catch(()=>K("...載入失敗。")),await V("初始化技能資料..."),n.a.SkillSystem.init_SkillQuery(document.querySelector("#SkillQuery > .main")),U({top_menu:document.getElementById("top_menu")})}(),document.getElementById("SkillQuery").setAttribute("data-ready","1")}catch(e){K(e),console.log(e)}}]);