<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
    <div id="main"></div>
    <a href="" id="save">儲存</a>
    <script src="../js/plugin/papaparse.min.js"></script>
    <script type="module" src="process_item.js"></script>
    <script type="module">
        import {start, MainProcess} from "./process_item.js";
        import DATA from "./item_data.js";
        (async function(){
            await start();
            const csv = Papa.unparse(MainProcess(DATA));
            const a = document.getElementById('save');
            const fileName = 'data.csv';
            const file = new Blob([csv], {type: 'csv'});
            a.href = URL.createObjectURL(file);
            a.download = fileName;
            a.click();
        })();
    </script>
</body>
</html>